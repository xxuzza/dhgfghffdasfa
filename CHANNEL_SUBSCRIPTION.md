# Настройка проверки подписки на канал

## ВАЖНО: Бот должен быть администратором канала!

Telegram API не позволяет проверять подписку на канал без добавления бота как администратора.

## Шаг 1: Добавь бота в канал как администратора

1. Открой свой канал
2. Настройки → Администраторы → Добавить администратора
3. Найди своего бота (поиск по username)
4. Дай **минимальные права**:
   - ✅ Только галочка на "Добавление участников" (или вообще без прав)
   - ❌ Все остальное выключено
5. Сохрани

**Примечание:** Бот будет виден в списке администраторов, но не будет ничего делать в канале.

## Шаг 2: Получи ID канала

### Способ 1: Через @userinfobot
1. Перешли любое сообщение из канала боту @userinfobot
2. Он покажет ID канала (например: `-1001234567890`)

### Способ 2: Через @getidsbot  
1. Перешли сообщение из канала боту @getidsbot
2. Он покажет ID

### Способ 3: Вручную
1. Открой канал в веб-версии: https://web.telegram.org
2. Посмотри в URL: `https://web.telegram.org/k/#-1001234567890`
3. Число после `#` - это ID канала

## Шаг 3: Настрой .env файл

Добавь в `.env`:

```env
# Username канала (с @)
REQUIRED_CHANNEL=@stewvpn_channel

# ID канала (число с минусом, начинается с -100)
REQUIRED_CHANNEL_ID=-1001234567890
```

**Важно:** ID канала всегда начинается с `-100`

## Шаг 4: Перезапусти бота

```bash
# Если через screen
screen -r vpn_bot
# Ctrl+C
python3 bot.py
# Ctrl+A, D

# Если через systemd
sudo systemctl restart vpn_bot
```

## Как работает:

1. Пользователь запускает бота `/start`
2. Бот проверяет подписку через API
3. Если не подписан - показывает кнопку "Подписаться"
4. После подписки нажимает "Я подписался"
5. Бот проверяет снова и пускает дальше

## Отключить проверку:

Если хочешь отключить проверку подписки:

```env
# Оставь пустым
REQUIRED_CHANNEL_ID=
```

## Пример настройки:

```env
TELEGRAM_BOT_TOKEN=8528861698:AAE9Mr8fx8mt85JD14Koj-VvbF7xVjHQegE
REQUIRED_CHANNEL=@stewvpn_channel
REQUIRED_CHANNEL_ID=-1001234567890
ADMIN_ID=8145856236
```

## Проверка:

1. Убедись что бот добавлен в канал как администратор
2. Запусти бота
3. Отпишись от канала
4. Нажми `/start` в боте
5. Должно показать сообщение о подписке
6. Подпишись на канал
7. Нажми "Я подписался"
8. Должно пропустить дальше

## Troubleshooting:

### Ошибка "bot is not a member"
- Бот не добавлен в канал
- Добавь бота как администратора

### Ошибка "chat not found"
- Неправильный ID канала
- Проверь ID через @userinfobot

### Бот пускает всех без проверки
- REQUIRED_CHANNEL_ID пустой или не настроен
- Проверь .env файл

Готово!
